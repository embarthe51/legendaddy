<div class="activities_content">
  <div class="row justify-content-center">
    <div class="col-sm-8 justify-content-center">
      <div class="title_description">
        <% @filtered_activities.each do |activity| %>
          <%= link_to activity_path(activity) do %>
            <div class="card-product">
              <% if activity.photos.any? %>
              <%= cl_image_tag(activity.photos.first.key, width: 350, height: 300, crop: :fill, gravity: :center) %>
              <% else %>
              <%= image_tag 'papa.jpeg', width: 350, height: 300 %>
              <% end %>
              <div class="card-product-infos">
                <h4 class="activity_title"><%= activity.title %></h4>
                <p class="activity_description"><%= activity.description.truncate(50) %></p>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="map_image" style="width: 100%; height: 600px;"
  data-controller="map"
  data-map-markers-value="<%= @markers.to_json %>"
  data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  
<div class="container" data-controller="activity-search">
  <%= simple_form_for :query,
                    url: search_activities_path,
                    method: :get,
                    html: {
                      data: {
                        action: "submit->activity-search#search",
                        'activity-search-target'=>'form'
                      }
                    } do |f| %>
  <%= f.input :tag_list,
              as: :check_boxes,
              collection: ActsAsTaggableOn::Tag.all,
              value_method: :name,
              checked: params.dig(:query, :tag_list),
              input_html: {
                class: "tag-selector",
                data: { action: "click->activity-search#search" }
              },
              item_wrapper_class: 'tag-item'%>
  <% end %>


  <div class="row justify-content-center">
    <div class="col-sm-8">
      <div id="activities" data-activity-search-target="activities">
        <%= render 'list', filtered_activities: @filtered_activities %>
      </div>
    </div>
  </div>
  <div data-activity-search-target="map">
    <%= render 'map', markers: @markers %>
  </div>
</div>
